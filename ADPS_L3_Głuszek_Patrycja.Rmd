---
title: "ADPS 2025Z --- Laboratorium 3 (rozwiązania)"
author: "Patrycja Głuszek"
output:
  pdf_document: 
    latex_engine: xelatex
  html_document: default
  html_notebook: default
editor_options: 
  markdown: 
    wrap: 72
---

```{r, echo=FALSE}
pdf.options(encoding='ISOLatin2')
```

# Zadanie 1 (1 pkt)

## Treść zadania

Plik tempciala.txt zawiera zarejestrowane wartości tętna oraz
temperatury ciała dla 65 mężczyzn (płeć = 1) i 65 kobiet (płeć = 2).

Osobno dla mężczyzn i kobiet:

-   wyestymuj wartość średnią i odchylenie standardowe temperatury,

-   zweryfikuj przy poziomie istotności $\alpha = 0.05$ hipotezę, że
    średnia temperatura jest równa 36.6 $^\circ$C wobec hipotezy
    alternatywnej, że średnia temperatura jest inna, przyjmując, że
    temperatury mają rozkład normalny, a wariancja rozkładu jest
    nieznana.

## Rozwiązanie

Tu umieść swoje rozwiązanie

```{r}
dane <- read.csv("tempciala.txt", fileEncoding = "UTF-8")
mezczyzni <- dane$temperatura[dane$płeć == 1]
kobiety   <- dane$temperatura[dane$płeć == 2]
mean_m <- mean(mezczyzni); sd_m <- sd(mezczyzni)
mean_k <- mean(kobiety);   sd_k <- sd(kobiety)
mi_0 <- 36.6
alfa <- 0.05
n_m <- length(mezczyzni)
T_m <- abs(mean_m - mi_0) * sqrt(n_m) / sd_m
c_m <- qt(1 - alfa/2, df = n_m - 1)
p_val_m <- 2 * (1 - pt(T_m, df = n_m - 1))
n_k <- length(kobiety)
T_k <- abs(mean_k - mi_0) * sqrt(n_k) / sd_k
c_k <- qt(1 - alfa/2, df = n_k - 1)
p_val_k <- 2 * (1 - pt(T_k, df = n_k - 1))
t_m <- t.test(mezczyzni, mu = mi_0)
t_k <- t.test(kobiety, mu = mi_0)
list(
  Mezczyzni = list(mean = mean_m, sd = sd_m, T = T_m, c = c_m, p = p_val_m, test = t_m),
  Kobiety   = list(mean = mean_k, sd = sd_k, T = T_k, c = c_k, p = p_val_k, test = t_k)
)
```

## WNIOSKI

Średnie i odchylenia standardowe temperatury ciała wyniosły:

-   Mężczyźni: średnia = 36.73 $^\circ$C, SD = 0.39 $^\circ$C

-   Kobiety: średnia = 36.89 $^\circ$C, SD = 0.41 $^\circ$C

Przy poziomie istotności 0.05 zweryfikowano hipotezę:

$$
H_0 : \mu = 36.6 \quad\quad H_1 : \mu \neq 36.6
$$

**Wyniki testu:**

**Mężczyźni**: $t = 2.62$, $p = 0.011 < 0.05$\
Wniosek: odrzucamy $H_0$. Średnia temperatura mężczyzn różni się
istotnie od 36.6 $^\circ$C.

**Kobiety**: $t = 5.65$, $p \approx 4 \cdot 10^{-7} < 0.05$\
Wniosek: odrzucamy $H_0$. Średnia temperatura kobiet różni się istotnie
od 36.6 $^\circ$C.

**Przedziały ufności 95%:**

-   Mężczyźni: (36.63; 36.82)\
-   Kobiety: (36.79; 36.99)

------------------------------------------------------------------------

# Zadanie 2 (1 pkt)

## Treść zadania

W tabeli przedstawionej poniżej zawarto dane dot. liczby samobójstw w
Stanach Zjednoczonych w 1970 roku z podziałem na poszczególne miesiące.

| Miesiąc     | Liczba samobójstw | Liczba dni |
|:------------|:-----------------:|:----------:|
| Styczeń     |       1867        |     31     |
| Luty        |       1789        |     28     |
| Marzec      |       1944        |     31     |
| Kwiecień    |       2094        |     30     |
| Maj         |       2097        |     31     |
| Czerwiec    |       1981        |     30     |
| Lipiec      |       1887        |     31     |
| Sierpień    |       2024        |     31     |
| Wrzesień    |       1928        |     30     |
| Październik |       2032        |     31     |
| Listopad    |       1978        |     30     |
| Grudzień    |       1859        |     31     |

Zweryfikuj przy poziomie istotności $\alpha = 0.05$ czy zamieszczone w
niej dane świadczą o stałej intensywności badanego zjawiska, czy raczej
wskazują na sezonową zmienność liczby samobójstw. Przyjmij, że w
przypadku stałej intensywności liczby samobójstw, liczba samobójstw w
danym miesiącu jest proporcjonalna do liczby dni w tym miesiącu.

## Rozwiązanie

Tu umieść swoje rozwiązanie

```{r}
samobojstwa <- c(1867, 1789, 1944, 2094, 2097, 1981,
                 1887, 2024, 1928, 2032, 1978, 1859)
dni <- c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)
r <- length(samobojstwa)
N <- sum(samobojstwa)
p_i <- dni / sum(dni)  
E_i <- N * p_i
T <- sum((samobojstwa - E_i)^2 / E_i)
alfa <- 0.05
c <- qchisq(1 - alfa, df = r - 1)
p_val <- 1 - pchisq(T, df = r - 1)
T; c; p_val
chisq.test(samobojstwa, p = p_i)
```

## WNIOSKI

**Hipotezy:**

$H_0$: liczba samobójstw w miesiącu jest proporcjonalna do liczby dni w
tym miesiącu (stała intensywność)

$H_1$: liczba samobójstw różni się od proporcjonalnej --- występuje
sezonowość

**Wyniki testu chi‑kwadrat:**

Statystyka: $x^{2}$ = 47.37

Stopnie swobody: df = 11

Wartość krytyczna ($\alpha = 0.05$)= 19.68

p-value: $1.85 \times 10^{-6}$

**Wnioski:**

Odrzucamy $H_0$. Dane wskazują na sezonową zmienność liczby samobójstw,
intensywność zjawiska nie jest stała w ciągu roku.

------------------------------------------------------------------------

# Zadanie 3 (1 pkt)

## Treść zadania

Dla wybranej spółki notowanej na GPW wczytaj dane ze strony stooq.pl, a
następnie

-   oblicz wartości procentowych zmian najniższych cen w poszczególnych
    dniach w ciągu ostatniego roku, wykreśl ich histogram i narysuj
    funkcję gęstości prawdopodobieństwa rozkładu normalnego o
    parametrach wyestymowanych na podstawie ich wartości,

-   stosując rózne testy omawiane w przykładach zweryfikuj przy poziomie
    istotności $\alpha = 0.05$ hipotezę, że procentowe zmiany
    najniższych cen w poszczególnych dniach w ciągu ostatniego roku mają
    rozkład normalny.

## Rozwiązanie

Tu umieść swoje rozwiązanie

```{r}
library(quantmod)
library(TTR)
sym <- "PKO.WA"
getSymbols(sym, src = "yahoo")
dane <- get(sym)
dane <- dane[(index(dane) >= Sys.Date() - 365), ]
low <- Lo(dane)
zmiany <- Delt(low) * 100
zmiany <- na.omit(zmiany)
hist(coredata(zmiany), breaks = 20, freq = FALSE,
     main = "Histogram zmian % (Low) PKO.WA ostatni rok",
     xlab = "Zmiana [%]")
curve(dnorm(x, mean = mean(zmiany), sd = sd(zmiany)),
      col = "darkblue", lwd = 2, add = TRUE)
shapiro.test(coredata(zmiany))
ks.test(coredata(zmiany), "pnorm", mean = mean(zmiany), sd = sd(zmiany))
library(moments)
anscombe.test(as.numeric(coredata(zmiany)))
agostino.test(as.numeric(coredata(zmiany)))
jarque.test(as.numeric(coredata(zmiany)))
```

## WNIOSKI

**Hipotezy:**

$H_0$: procentowe zmiany najniższych cen mają rozkład normalny

$H_1$: procentowe zmiany nie mają rozkładu normalnego

**Wyniki:**

-   Kolmogorov--Smirnov: D = 0.092, p‑value = 0.030 \< 0.05 odrzucamy
    $H_0$

-   Anscombe--Glynn (kurtoza): kurt = 9.05, p‑value = 2.2e‑10 odrzucamy
    $H_0$ Dane mają znacznie większą kurtozę niż 3 (grube ogony).

-   D'Agostino (skośność): skew = --1.10, p‑value = 1.7e‑09 odrzucamy
    $H_0$ Dane są istotnie skośne (lewa skośność).

-   Jarque--Bera: JB = 425.9, p‑value \< 2.2e‑16 odrzucamy $H_0$

**Wnioski:**

Przy poziomie istotności $\alpha = 0.05$ wszystkie testy wskazują na
odrzucenie hipotezy zerowej. Procentowe zmiany najniższych cen spółki
PKO.WA w ostatnim roku nie mają rozkładu normalnego -- rozkład cechuje
się istotną lewą skośnością oraz podwyższoną kurtozą (grube ogony), co
jest typowe dla danych finansowych.

------------------------------------------------------------------------

# Zadanie 4 (1 pkt)

## Treść zadania

W pliku lozyska.txt podane są czasy (w milionach cykli) pracy (do
momentu uszkodzenia) łożysk wykonywanych z dwóch różnych materiałów.

-   Przeprowadź test braku różnicy między czasami pracy łożysk
    wykonanych z różnych materiałów, zakładając że czas pracy do momentu
    uszkodzenia opisuje się rozkładem normalnym, bez zakładania róności
    wariancji. Przyjmij poziom istotności $\alpha = 0.05$.

-   Przeprowadź analogiczny test, bez zakładania normalności rozkładów.

-   **(dla chętnych)** Oszacuj prawdopodobieństwo tego, że łożysko
    wykonane z pierwszego materiału będzie pracowało dłużej niż łożysko
    wykonane z materiału drugiego.

## Rozwiązanie

Tu umieść swoje rozwiązanie

```{r}
dane <- read.csv("lozyska.txt", header = TRUE, sep = ",", quote = "'")
str(dane)
x1 <- dane$Typ.I
x2 <- dane$Typ.II
test_t <- t.test(x1, x2)
print(test_t)
test_wilcox <- wilcox.test(x1, x2)
print(test_wilcox)
prawdopodobienstwo <- mean(outer(x1, x2, FUN = ">"))
print(paste("Prawdopodobieństwo, że łożysko z materiału I pracuje dłużej:", round(prawdopodobienstwo, 3)))
```

## WNIOSKI

**Hipotezy:**

$H_0$: średnie czasy pracy łożysk z obu materiałów są równe

$H_1$: średnie czasy pracy różnią się między materiałami

**Wyniki:**

-   Test t‑Studenta:\
    t = 2.07, df = 16.7, p‑value = 0.054, ponieważ p‑value \> 0.05, brak
    podstaw do odrzucenia hipotezy zerowej -- różnica średnich nie jest
    istotna statystycznie.

-   Test nieparametryczny (Wilcoxona):\
    W = 75, p‑value = 0.063, ponieważ p‑value \> 0.05, również brak
    podstaw do odrzucenia hipotezy zerowej -- różnica median nie jest
    istotna statystycznie.

**(dla chętnych) Prawdopodobieństwo:**

Szacowane prawdopodobieństwo, że łożysko z materiału I pracuje dłużej
niż z materiału II, wynosi 0.75 (czyli w 75% przypadków).

Należy przez to rozumieć, że wynik np. 0.65 oznacza, że w \~65%
przypadków łożysko z materiału I pracuje dłużej niż z materiału II.

**Wnioski:**

Przy poziomie istotności $\alpha = 0.05$ zarówno test t‑Studenta, jak i
test Wilcoxona nie wykazały istotnej różnicy między czasami pracy łożysk
z dwóch materiałów. Oznacza to, że na podstawie przeprowadzonych testów
nie ma dowodów, iż materiał wpływa na trwałość łożysk. Dodatkowo
oszacowane prawdopodobieństwo (0.75) sugeruje jednak, że w większości
przypadków łożysko z materiału I pracuje dłużej niż z materiału II, choć
różnica ta nie jest potwierdzona statystycznie na poziomie istotności
0.05.

------------------------------------------------------------------------

# Zadanie 5 (1 pkt)

## Treść zadania

Korzystając z danych zawartych na stronie pl.fcstats.com zweryfikuj
hipotezę o niezależności wyników (zwycięstw, remisów i porażek)
gospodarzy od kraju, w którym prowadzone są rozgrywki piłkarskie.
Przyjmij poziom istotności $\alpha = 0.05$.

-   Testy przeprowadź na podstawie danych dotyczących lig:

    -   niemieckiej -- Bundesliga (Liga niemiecka),

    -   polskiej -- Ekstraklasa (Liga polska),

    -   angielskiej -- Premier League (Liga angielska),

    -   hiszpańskiej -- LaLiga (Liga hiszpańska).

-   Dane znajdują się w zakładce Porównanie lig -\> Zwycięzcy meczów, w
    kolumnach (bez znaku [%]):

    -   1 -- zwycięstwa gospodarzy, np. dla ligi niemieckiej
        (Bundesliga) 125,

    -   x -- remisy, np. dla ligi niemieckiej 86,

    -   2 -- porażki gospodarzy, np. dla ligi niemieckiej 95.

## Rozwiązanie

Tu umieść swoje rozwiązanie

```{r}
# Dane: liczba zwycięstw (1), remisów (x), porażek (2) gospodarzy
# Bundesliga: 125 zwycięstw, 86 remisów, 95 porażek
# Ekstraklasa: 108 zwycięstw, 65 remisów, 67 porażek
# Premier League: 193 zwycięstw, 96 remisów, 91 porażek
# LaLiga: 194 zwycięstw, 95 remisów, 91 porażek
wyniki <- matrix(c(
  125, 86, 95,   # Bundesliga
  108, 65, 67,   # Ekstraklasa
  193, 96, 91,   # Premier League
  194, 95, 91    # LaLiga
), nrow = 4, byrow = TRUE)
rownames(wyniki) <- c("Bundesliga", "Ekstraklasa", "Premier League", "LaLiga")
colnames(wyniki) <- c("Zwycięstwa", "Remisy", "Porażki")
wyniki
test <- chisq.test(wyniki)
test
if (test$p.value < 0.05) {
  cat("Odrzucamy hipotezę niezależności: wyniki gospodarzy zależą od kraju.\n")
} else {
  cat("Brak podstaw do odrzucenia hipotezy niezależności: wyniki gospodarzy nie zależą od kraju.\n")
}
```

## WNIOSKI

**Hipotezy:** $H_0$: rozkład wyników gospodarzy (zwycięstwa, remisy,
porażki) jest niezależny od kraju ligi.\
$H_1$: rozkład wyników gospodarzy zależy od kraju ligi.

**Test:** Test chi‑kwadrat niezależności przeprowadzony na danych z
Bundesligi, Ekstraklasy, Premier League i LaLiga dał wynik: chi2 =
10.325, df = 6, p‑value = 0.1116.

**Wnioski**: Ponieważ p‑value \> 0.05, brak podstaw do odrzucenia
hipotezy zerowej. Oznacza to, że przy poziomie istotności
$\alpha = 0.05$ nie stwierdzono zależności między wynikami gospodarzy a
krajem ligi -- proporcje zwycięstw, remisów i porażek są statystycznie
podobne w analizowanych ligach.

------------------------------------------------------------------------
